---
title: "The Kalman filter and the square root Kalman filter"
author: "Koichi (Koiti) Yano"
format: html
editor: visual
---

## Introduction

A linear Gaussian state space model is defined by the following two equations.

$$
x_t=Fx_{t-1} + E u_t + w_t
$$

and

$$y_t=Hx_t+v_t,$$

where $x_t$ is the $(k \times 1)$ state vector , $y_t$ is the $(l \times 1)$ observation vector, $u_t$ is the $(n \times 1)$ exogenous vector, $v_t$ is the $(k \times 1)$ state noise, $w(t)$ is the $(l \times 1)$ observation noise, $t$ is a time index. The Kalman Filter is used to estimate the state vector $x_t$ given the observations $y_t$.

The Kalman filter is implemented using the following recursion:

1.  Prediction step:

    1.  $x_{t|t-1} = F x_{t-1|t-1} + E u_t$

    2.  $P_{t|t-1} = F P_{t-1|t-1} F^t + V$

2.  Innovation step:

    1.  $e_t = y_t - H x_{t|t-1}$

    2.  $s_t = H P_{t-1|t-1}H^t + W$

3.  Update step:

    1.  $K_t=P_{t|t-1} H^t s_t^{-1}$

    2.  $x_{t|t} = x_{t|t-1} + K_t e_t$

    3.  $P_{t|t} = (I - K_t H) P_{t|t-1}$

where \eqn{x(t|t)} is the estimated state vector at, \#' \eqn{P(t)} is the estimated state covariance matrix, \#' and \eqn{K(t)} is the Kalman gain at time t.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
